require(methods)

if (exists("test.data.table", .GlobalEnv, inherits=FALSE)) {
  if ((tt<-compiler::enableJIT(-1))>0)
    cat("This is dev mode and JIT is enabled (level ", tt, ") so there will be a brief pause around the first test.\n", sep="")
} else {
  require(data.table)
  test = data.table:::test
}

x = as.data.table(lapply(1:5, c))
with = copy(NA) # copy for dev till we not duplicate yet, to ensure not to override NA value
# symbols and : calls on symbols
test(9999.111, exprCols(x, V1, "j", with, environment()), NULL) # NULL because it will evaluate that symbol in DT scope anyway, so with stays TRUE
test(9999.112, exprCols(x, V1, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.113, exprCols(x, V1, "by", with, environment()), NULL)
test(9999.114, exprCols(x, ((V1)), "j", with, environment()), NULL) # peel from (, NULL because it will evaluate that symbol in DT scope anyway, so with stays TRUE
test(9999.115, exprCols(x, ((V1)), ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.116, exprCols(x, ((V1)), "by", with, environment()), NULL)
test(9999.117, exprCols(x, {{V1}}, "j", with, environment()), NULL) # peel from {, NULL because it will evaluate that symbol in DT scope anyway, so with stays TRUE
test(9999.118, exprCols(x, {{V1}}, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.119, exprCols(x, {{V1}}, "by", with, environment()), NULL)
test(9999.121, exprCols(x, -V1, "j", with, environment()), NULL) # minus on column not an inverse selection
test(9999.122, exprCols(x, -V1, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.123, exprCols(x, -V1, "by", with, environment()), NULL)
test(9999.124, exprCols(x, ((-V1)), "j", with, environment()), NULL) # inverse selection only works before peeling
test(9999.125, exprCols(x, ((-V1)), ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.126, exprCols(x, ((-V1)), "by", with, environment()), NULL)
test(9999.127, exprCols(x, {{-V1}}, "j", with, environment()), NULL) # inverse selection only works before peeling
test(9999.128, exprCols(x, {{-V1}}, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.129, exprCols(x, {{-V1}}, "by", with, environment()), NULL)
test(9999.131, exprCols(x, !V1, "j", with, environment()), NULL) # bang inverse selection
test(9999.132, exprCols(x, !V1, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.133, exprCols(x, !V1, "by", with, environment()), NULL)
test(9999.134, exprCols(x, ((!V1)), "j", with, environment()), NULL) # inverse selection only works before peeling
test(9999.135, exprCols(x, ((!V1)), ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.136, exprCols(x, ((!V1)), "by", with, environment()), NULL)
test(9999.137, exprCols(x, {{!V1}}, "j", with, environment()), NULL) # inverse selection only works before peeling
test(9999.138, exprCols(x, {{!V1}}, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.139, exprCols(x, {{!V1}}, "by", with, environment()), NULL)
test(9999.141, exprCols(x, V1:V3, "j", with, environment()), 1:3) # colon symbols range selection
test(9999.142, exprCols(x, V1:V3, ".SDcols", with, environment()), 1:3)
#test(9999.143, exprCols(x, V1:V3, "by", with, environment()), 1:3)
test(9999.144, exprCols(x, ((V1:V3)), "j", with, environment()), NULL) # peeling disabled colon range selection in j
test(9999.145, exprCols(x, ((V1:V3)), ".SDcols", with, environment()), 1:3)
#test(9999.146, exprCols(x, ((V1:V3)), "by", with, environment()), NULL)
test(9999.147, exprCols(x, {{V1:V3}}, "j", with, environment()), NULL) # peeling disabled colon range selection in j
test(9999.148, exprCols(x, {{V1:V3}}, ".SDcols", with, environment()), 1:3)
#test(9999.149, exprCols(x, {{V1:V3}}, "by", with, environment()), NULL)
test(9999.151, exprCols(x, -V1:V3, "j", with, environment()), error="column selection mixes positives and negatives") # improper use of inverse and colon symbols range selection
test(9999.152, exprCols(x, -V1:V3, ".SDcols", with, environment()), error="column selection mixes positives and negatives") # related #4231
#test(9999.153, exprCols(x, -V1:V3, "by", with, environment()), error="column selection mixes positives and negatives")
test(9999.154, exprCols(x, ((-V1:V3)), "j", with, environment()), NULL)
test(9999.155, exprCols(x, ((-V1:V3)), ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.156, exprCols(x, ((-V1:V3)), "by", with, environment()), NULL)
test(9999.157, exprCols(x, {{-V1:V3}}, "j", with, environment()), NULL)
test(9999.158, exprCols(x, {{-V1:V3}}, ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.159, exprCols(x, {{-V1:V3}}, "by", with, environment()), NULL)
test(9999.161, exprCols(x, -(V1:V3), "j", with, environment()), 4:5) # proper use of minus inverse selection and colon symbols range selection
test(9999.162, exprCols(x, -(V1:V3), ".SDcols", with, environment()), 4:5)
#test(9999.163, exprCols(x, -(V1:V3), "by", with, environment()), 4:5)
test(9999.164, exprCols(x, ((-(V1:V3))), "j", with, environment()), NULL)
test(9999.165, exprCols(x, ((-(V1:V3))), ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.166, exprCols(x, ((-(V1:V3))), "by", with, environment()), NULL)
test(9999.167, exprCols(x, {{-(V1:V3)}}, "j", with, environment()), NULL)
test(9999.168, exprCols(x, {{-(V1:V3)}}, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.169, exprCols(x, {{-(V1:V3)}}, "by", with, environment()), NULL)
test(9999.171, exprCols(x, !V1:V3, "j", with, environment()), 4:5) # proper use of bang inverse selection and colon symbols range selection
test(9999.172, exprCols(x, !V1:V3, ".SDcols", with, environment()), 4:5)
#test(9999.173, exprCols(x, !V1:V3, "by", with, environment()), 4:5)
test(9999.174, exprCols(x, ((!V1:V3)), "j", with, environment()), NULL)
test(9999.175, exprCols(x, ((!V1:V3)), ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.176, exprCols(x, ((!V1:V3)), "by", with, environment()), NULL)
test(9999.177, exprCols(x, {{!V1:V3}}, "j", with, environment()), NULL)
test(9999.178, exprCols(x, {{!V1:V3}}, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.179, exprCols(x, {{!V1:V3}}, "by", with, environment()), NULL)
test(9999.181, exprCols(x, !(V1:V3), "j", with, environment()), 4:5) # another proper use of bang inverse selection and colon symbols range selection
test(9999.182, exprCols(x, !(V1:V3), ".SDcols", with, environment()), 4:5)
#test(9999.183, exprCols(x, !(V1:V3), "by", with, environment()), 4:5)
test(9999.184, exprCols(x, ((!(V1:V3))), "j", with, environment()), NULL)
test(9999.185, exprCols(x, ((!(V1:V3))), ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.186, exprCols(x, ((!(V1:V3))), "by", with, environment()), NULL)
test(9999.187, exprCols(x, {{!(V1:V3)}}, "j", with, environment()), NULL)
test(9999.188, exprCols(x, {{!(V1:V3)}}, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.189, exprCols(x, {{!(V1:V3)}}, "by", with, environment()), NULL)
test(9999.191, exprCols(x, V3:V1, "j", with, environment()), 3:1) # colon symbols range selection desc order
test(9999.192, exprCols(x, V3:V1, ".SDcols", with, environment()), 3:1)
#test(9999.193, exprCols(x, V3:V1, "by", with, environment()), 3:1)
test(9999.194, exprCols(x, ((V3:V1)), "j", with, environment()), NULL)
test(9999.195, exprCols(x, ((V3:V1)), ".SDcols", with, environment()), 3:1)
#test(9999.196, exprCols(x, ((V3:V1)), "by", with, environment()), NULL)
test(9999.197, exprCols(x, {{V3:V1}}, "j", with, environment()), NULL)
test(9999.198, exprCols(x, {{V3:V1}}, ".SDcols", with, environment()), 3:1)
#test(9999.199, exprCols(x, {{V3:V1}}, "by", with, environment()), NULL)
test(9999.201, exprCols(x, -V3:V1, "j", with, environment()), error="column selection mixes positives and negatives") # improper use of minus inverse selection and colon symbols range selection desc order
test(9999.202, exprCols(x, -V3:V1, ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.203, exprCols(x, -V3:V1, "by", with, environment()), NULL)
test(9999.204, exprCols(x, ((-V3:V1)), "j", with, environment()), NULL)
test(9999.205, exprCols(x, ((-V3:V1)), ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.206, exprCols(x, ((-V3:V1)), "by", with, environment()), NULL)
test(9999.207, exprCols(x, {{-V3:V1}}, "j", with, environment()), NULL)
test(9999.208, exprCols(x, {{-V3:V1}}, ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.209, exprCols(x, {{-V3:V1}}, "by", with, environment()), NULL)
test(9999.211, exprCols(x, -(V3:V1), "j", with, environment()), 4:5) # proper use of minus inverse selection and colon symbols range selection desc order
test(9999.212, exprCols(x, -(V3:V1), ".SDcols", with, environment()), 4:5)
#test(9999.213, exprCols(x, -(V3:V1), "by", with, environment()), 4:5)
test(9999.214, exprCols(x, ((-(V3:V1))), "j", with, environment()), NULL)
test(9999.215, exprCols(x, ((-(V3:V1))), ".SDcols", with, environment()), error="object 'V3' not found")
#test(9999.216, exprCols(x, ((-(V3:V1))), "by", with, environment()), NULL)
test(9999.217, exprCols(x, {{-(V3:V1)}}, "j", with, environment()), NULL)
test(9999.218, exprCols(x, {{-(V3:V1)}}, ".SDcols", with, environment()), error="object 'V3' not found")
#test(9999.219, exprCols(x, {{-(V3:V1)}}, "by", with, environment()), NULL)
test(9999.221, exprCols(x, !V3:V1, "j", with, environment()), 4:5) # bang inverse selection and colon symbols range selection desc order
test(9999.222, exprCols(x, !V3:V1, ".SDcols", with, environment()), 4:5)
#test(9999.223, exprCols(x, !V3:V1, "by", with, environment()), 4:5)
test(9999.224, exprCols(x, ((!V3:V1)), "j", with, environment()), NULL)
test(9999.225, exprCols(x, ((!V3:V1)), ".SDcols", with, environment()), error="object 'V3' not found")
#test(9999.226, exprCols(x, ((!V3:V1)), "by", with, environment()), NULL)
test(9999.227, exprCols(x, {{!V3:V1}}, "j", with, environment()), NULL)
test(9999.228, exprCols(x, {{!V3:V1}}, ".SDcols", with, environment()), error="object 'V3' not found")
#test(9999.229, exprCols(x, {{!V3:V1}}, "by", with, environment()), NULL)
test(9999.231, exprCols(x, !(V3:V1), "j", with, environment()), 4:5) # another bang inverse selection and colon symbols range selection desc order
test(9999.232, exprCols(x, !(V3:V1), ".SDcols", with, environment()), 4:5)
#test(9999.233, exprCols(x, !(V3:V1), "by", with, environment()), 4:5)
test(9999.234, exprCols(x, ((!(V3:V1))), "j", with, environment()), NULL)
test(9999.235, exprCols(x, ((!(V3:V1))), ".SDcols", with, environment()), error="object 'V3' not found")
#test(9999.236, exprCols(x, ((!(V3:V1))), "by", with, environment()), NULL)
test(9999.237, exprCols(x, {{!(V3:V1)}}, "j", with, environment()), NULL)
test(9999.238, exprCols(x, {{!(V3:V1)}}, ".SDcols", with, environment()), error="object 'V3' not found")
#test(9999.239, exprCols(x, {{!(V3:V1)}}, "by", with, environment()), NULL)
# character
test(9999.301, exprCols(x, "V1", "j", with, environment()), 1L) # character column selection
test(9999.302, exprCols(x, "V1", ".SDcols", with, environment()), 1L)
#test(9999.303, exprCols(x, "V1", "by", with, environment()), 1L)
test(9999.304, exprCols(x, (("V1")), "j", with, environment()), NULL) # peeling stops NSE
test(9999.305, exprCols(x, (("V1")), ".SDcols", with, environment()), 1L)
#test(9999.306, exprCols(x, (("V1")), "by", with, environment()), NULL)
test(9999.307, exprCols(x, {{"V1"}}, "j", with, environment()), NULL)
test(9999.308, exprCols(x, {{"V1"}}, ".SDcols", with, environment()), 1L)
#test(9999.309, exprCols(x, {{"V1"}}, "by", with, environment()), NULL)
test(9999.311, exprCols(x, -"V1", "j", with, environment()), 2:5) # minus inverse character column selection
test(9999.312, exprCols(x, -"V1", ".SDcols", with, environment()), 2:5)
#test(9999.313, exprCols(x, -"V1", "by", with, environment()), 2:5)
test(9999.314, exprCols(x, ((-"V1")), "j", with, environment()), NULL)
test(9999.315, exprCols(x, ((-"V1")), ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.316, exprCols(x, ((-"V1")), "by", with, environment()), NULL)
test(9999.317, exprCols(x, {{-"V1"}}, "j", with, environment()), NULL)
test(9999.318, exprCols(x, {{-"V1"}}, ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.319, exprCols(x, {{-"V1"}}, "by", with, environment()), NULL)
test(9999.321, exprCols(x, !"V1", "j", with, environment()), 2:5) # bang inverse character column selection
test(9999.322, exprCols(x, !"V1", ".SDcols", with, environment()), 2:5)
#test(9999.323, exprCols(x, !"V1", "by", with, environment()), 2:5)
test(9999.324, exprCols(x, ((!"V1")), "j", with, environment()), NULL)
test(9999.325, exprCols(x, ((!"V1")), ".SDcols", with, environment()), error="invalid argument type")
#test(9999.326, exprCols(x, ((!"V1")), "by", with, environment()), NULL)
test(9999.327, exprCols(x, {{!"V1"}}, "j", with, environment()), NULL)
test(9999.328, exprCols(x, {{!"V1"}}, ".SDcols", with, environment()), error="invalid argument type")
#test(9999.329, exprCols(x, {{!"V1"}}, "by", with, environment()), NULL)
test(9999.331, exprCols(x, c("V1","V3"), "j", with, environment()), c(1L,3L)) # character vector columns selection
test(9999.332, exprCols(x, c("V1","V3"), ".SDcols", with, environment()), c(1L,3L))
#test(9999.333, exprCols(x, c("V1","V3"), "by", with, environment()), c(1L,3L))
test(9999.334, exprCols(x, ((c("V1","V3"))), "j", with, environment()), NULL) # wrapped character vector columns selection
test(9999.335, exprCols(x, ((c("V1","V3"))), ".SDcols", with, environment()), c(1L,3L))
#test(9999.336, exprCols(x, ((c("V1","V3"))), "by", with, environment()), NULL)
test(9999.337, exprCols(x, {{c("V1","V3")}}, "j", with, environment()), NULL) # another wrapped character vector columns selection
test(9999.338, exprCols(x, {{c("V1","V3")}}, ".SDcols", with, environment()), c(1L,3L))
#test(9999.339, exprCols(x, {{c("V1","V3")}}, patterns"by", with, environment()), NULL)
test(9999.341, exprCols(x, -c("V1","V3"), "j", with, environment()), c(2L,4L,5L)) # minus inverse character vector columns selection
test(9999.342, exprCols(x, -c("V1","V3"), ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.343, exprCols(x, -c("V1","V3"), "by", with, environment()), c(2L,4L,5L))
test(9999.344, exprCols(x, ((-c("V1","V3"))), "j", with, environment()), NULL)
test(9999.345, exprCols(x, ((-c("V1","V3"))), ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.346, exprCols(x, ((-c("V1","V3"))), "by", with, environment()), NULL)
test(9999.347, exprCols(x, {{-c("V1","V3")}}, "j", with, environment()), NULL)
test(9999.348, exprCols(x, {{-c("V1","V3")}}, ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.349, exprCols(x, {{-c("V1","V3")}}, "by", with, environment()), NULL)
test(9999.351, exprCols(x, !c("V1","V3"), "j", with, environment()), c(2L,4L,5L)) # bang inverse character vector columns selection
test(9999.352, exprCols(x, !c("V1","V3"), ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.353, exprCols(x, !c("V1","V3"), "by", with, environment()), c(2L,4L,5L))
test(9999.354, exprCols(x, ((!c("V1","V3"))), "j", with, environment()), NULL)
test(9999.355, exprCols(x, ((!c("V1","V3"))), ".SDcols", with, environment()), error="invalid argument type")
#test(9999.356, exprCols(x, ((!c("V1","V3"))), "by", with, environment()), NULL)
test(9999.357, exprCols(x, {{!c("V1","V3")}}, "j", with, environment()), NULL)
test(9999.358, exprCols(x, {{!c("V1","V3")}}, ".SDcols", with, environment()), error="invalid argument type")
#test(9999.359, exprCols(x, {{!c("V1","V3")}}, "by", with, environment()), NULL)
test(9999.361, exprCols(x, "V1,V3", "j", with, environment()), error="non existing") # multi column character scalar columns selection - only supported in by
## TODO error message change from to
# column(s) not found: V1,V3
# argument specifying columns specify non existing column(s): cols[1]='V1,V3'
test(9999.362, exprCols(x, "V1,V3", ".SDcols", with, environment()), error="non existing")
## TODO error message change from to
# Some items of .SDcols are not column names: [V1,V3]
# argument specifying columns specify non existing column(s): cols[1]='V1,V3'
#test(9999.363, exprCols(x, "V1,V3", "by", with, environment()), c(1L,3L)) # this only should work
test(9999.364, exprCols(x, (("V1,V3")), "j", with, environment()), NULL)
test(9999.365, exprCols(x, (("V1,V3")), ".SDcols", with, environment()), error="non existing")
## TODO error message change from to
# Some items of .SDcols are not column names: [V1,V3]
# argument specifying columns specify non existing column(s): cols[1]='V1,V3'
#test(9999.366, exprCols(x, (("V1,V3")), "by", with, environment()), NULL)
test(9999.367, exprCols(x, {{"V1,V3"}}, "j", with, environment()), NULL)
test(9999.368, exprCols(x, {{"V1,V3"}}, ".SDcols", with, environment()), error="non existing")
#test(9999.369, exprCols(x, {{"V1,V3"}}, "by", with, environment()), NULL)
test(9999.371, exprCols(x, -"V1,V3", "j", with, environment()), 1:5, warning="not excluded because not found")
## TODO warning message change from to
# column(s) not removed because not found: [V1,V3]
# column(s) not excluded because not found: V1,V3
test(9999.372, exprCols(x, -"V1,V3", ".SDcols", with, environment()), 1:5, warning="not excluded because not found")
## TODO error changed to warning
# Some items of .SDcols are not column names: [V1,V3]
# column(s) not excluded because not found: V1,V3
#test(9999.373, exprCols(x, -"V1,V3", "by", with, environment()), 1:5, warning="not excluded because not found")
test(9999.374, exprCols(x, ((-"V1,V3")), "j", with, environment()), NULL)
test(9999.375, exprCols(x, ((-"V1,V3")), ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.376, exprCols(x, ((-"V1,V3")), "by", with, environment()), NULL)
test(9999.377, exprCols(x, {{-"V1,V3"}}, "j", with, environment()), NULL)
test(9999.378, exprCols(x, {{-"V1,V3"}}, ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.379, exprCols(x, {{-"V1,V3"}}, "by", with, environment()), NULL)
test(9999.381, exprCols(x, !"V1,V3", "j", with, environment()), 1:5, warning="not excluded because not found")
test(9999.382, exprCols(x, !"V1,V3", ".SDcols", with, environment()), 1:5, warning="not excluded because not found")
#test(9999.383, exprCols(x, !"V1,V3", "by", with, environment()), 1:5, warning="not excluded because not found")
test(9999.384, exprCols(x, ((!"V1,V3")), "j", with, environment()), NULL)
test(9999.385, exprCols(x, ((!"V1,V3")), ".SDcols", with, environment()), error="invalid argument type")
#test(9999.386, exprCols(x, ((!"V1,V3")), "by", with, environment()), NULL)
test(9999.387, exprCols(x, {{!"V1,V3"}}, "j", with, environment()), NULL)
test(9999.388, exprCols(x, {{!"V1,V3"}}, ".SDcols", with, environment()), error="invalid argument type")
#test(9999.389, exprCols(x, {{!"V1,V3"}}, "by", with, environment()), NULL)
# numeric
test(9999.401, exprCols(x, 1L, "j", with, environment()), 1L)
test(9999.402, exprCols(x, 1L, ".SDcols", with, environment()), 1L)
#test(9999.403, exprCols(x, 1L, "by", with, environment()), 1L)
test(9999.404, exprCols(x, ((1L)), "j", with, environment()), NULL)
test(9999.405, exprCols(x, ((1L)), ".SDcols", with, environment()), 1L)
#test(9999.406, exprCols(x, ((1L)), "by", with, environment()), NULL)
test(9999.407, exprCols(x, {{1L}}, "j", with, environment()), NULL)
test(9999.408, exprCols(x, {{1L}}, ".SDcols", with, environment()), 1L)
#test(9999.409, exprCols(x, {{1L}}, "by", with, environment()), NULL)
test(9999.411, exprCols(x, -1L, "j", with, environment()), 2:5)
test(9999.412, exprCols(x, -1L, ".SDcols", with, environment()), 2:5)
#test(9999.413, exprCols(x, -1L, "by", with, environment()), 2:5)
test(9999.414, exprCols(x, ((-1L)), "j", with, environment()), NULL)
test(9999.415, exprCols(x, ((-1L)), ".SDcols", with, environment()), error="non existing column") # .SDcols #4231
#test(9999.416, exprCols(x, ((-1L)), "by", with, environment()), NULL)
test(9999.417, exprCols(x, {{-1L}}, "j", with, environment()), NULL)
test(9999.418, exprCols(x, {{-1L}}, ".SDcols", with, environment()), error="non existing column")
#test(9999.419, exprCols(x, {{-1L}}, "by", with, environment()), NULL)
test(9999.421, exprCols(x, !1L, "j", with, environment()), 2:5)
test(9999.422, exprCols(x, !1L, ".SDcols", with, environment()), 2:5)
#test(9999.423, exprCols(x, !1L, "by", with, environment()), 2:5)
test(9999.424, exprCols(x, ((!1L)), "j", with, environment()), NULL)
test(9999.425, exprCols(x, ((!1L)), ".SDcols", with, environment()), error="logical and has different length") #4115 #2178
#test(9999.426, exprCols(x, ((!1L)), "by", with, environment()), NULL)
test(9999.427, exprCols(x, {{!1L}}, "j", with, environment()), NULL)
test(9999.428, exprCols(x, {{!1L}}, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.429, exprCols(x, {{!1L}}, "by", with, environment()), NULL)
test(9999.431, exprCols(x, 1, "j", with, environment()), 1L)
test(9999.432, exprCols(x, 1, ".SDcols", with, environment()), 1L)
#test(9999.433, exprCols(x, 1, "by", with, environment()), 1L)
test(9999.434, exprCols(x, ((1)), "j", with, environment()), NULL)
test(9999.435, exprCols(x, ((1)), ".SDcols", with, environment()), 1L)
#test(9999.436, exprCols(x, ((1)), "by", with, environment()), NULL)
test(9999.437, exprCols(x, {{1}}, "j", with, environment()), NULL)
test(9999.438, exprCols(x, {{1}}, ".SDcols", with, environment()), 1L)
#test(9999.439, exprCols(x, {{1}}, "by", with, environment()), NULL)
test(9999.441, exprCols(x, -1, "j", with, environment()), 2:5)
test(9999.442, exprCols(x, -1, ".SDcols", with, environment()), 2:5)
#test(9999.443, exprCols(x, -1, "by", with, environment()), 2:5)
test(9999.444, exprCols(x, ((-1)), "j", with, environment()), NULL)
test(9999.445, exprCols(x, ((-1)), ".SDcols", with, environment()), error="non existing column") # .SDcols #4231
#test(9999.446, exprCols(x, ((-1)), "by", with, environment()), NULL)
test(9999.447, exprCols(x, {{-1}}, "j", with, environment()), NULL)
test(9999.448, exprCols(x, {{-1}}, ".SDcols", with, environment()), error="non existing column")
#test(9999.449, exprCols(x, {{-1}}, "by", with, environment()), NULL)
test(9999.451, exprCols(x, !1, "j", with, environment()), 2:5)
test(9999.452, exprCols(x, !1, ".SDcols", with, environment()), 2:5)
#test(9999.453, exprCols(x, !1, "by", with, environment()), 2:5)
test(9999.454, exprCols(x, ((!1)), "j", with, environment()), NULL)
test(9999.455, exprCols(x, ((!1)), ".SDcols", with, environment()), error="logical and has different length") #4115 #2178
#test(9999.456, exprCols(x, ((!1)), "by", with, environment()), NULL)
test(9999.457, exprCols(x, {{!1}}, "j", with, environment()), NULL)
test(9999.458, exprCols(x, {{!1}}, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.459, exprCols(x, {{!1}}, "by", with, environment()), NULL)
test(9999.461, exprCols(x, 1:2, "j", with, environment()), 1:2)
test(9999.462, exprCols(x, 1:2, ".SDcols", with, environment()), 1:2)
#test(9999.463, exprCols(x, 1:2, "by", with, environment()), 1:2)
test(9999.464, exprCols(x, ((1:2)), "j", with, environment()), NULL)
test(9999.465, exprCols(x, ((1:2)), ".SDcols", with, environment()), 1:2)
#test(9999.466, exprCols(x, ((1:2)), "by", with, environment()), NULL)
test(9999.467, exprCols(x, {{1:2}}, "j", with, environment()), NULL)
test(9999.468, exprCols(x, {{1:2}}, ".SDcols", with, environment()), 1:2)
#test(9999.469, exprCols(x, {{1:2}}, "by", with, environment()), NULL)
test(9999.471, exprCols(x, -1:2, "j", with, environment()), error="column selection mixes positives and negatives")
## TODO error message change from to
# j mixes positives and negatives
# column selection mixes positives and negatives
test(9999.472, exprCols(x, -1:2, ".SDcols", with, environment()), error="column selection mixes positives and negatives")
## TODO error message change from to
# .SDcols is numeric but has both +ve and -ve indices
# column selection mixes positives and negatives
#test(9999.473, exprCols(x, -1:2, "by", with, environment()), error="column selection mixes positives and negatives")
test(9999.474, exprCols(x, ((-1:2)), "j", with, environment()), NULL)
test(9999.475, exprCols(x, ((-1:2)), ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.476, exprCols(x, ((-1:2)), "by", with, environment()), NULL)
test(9999.477, exprCols(x, {{-1:2}}, "j", with, environment()), NULL)
test(9999.478, exprCols(x, {{-1:2}}, ".SDcols", with, environment()), error="column selection mixes positives and negatives")
#test(9999.479, exprCols(x, {{-1:2}}, "by", with, environment()), NULL)
test(9999.481, exprCols(x, -(1:2), "j", with, environment()), 3:5)
test(9999.482, exprCols(x, -(1:2), ".SDcols", with, environment()), 3:5)
#test(9999.483, exprCols(x, -(1:2), "by", with, environment()), 3:5)
test(9999.484, exprCols(x, ((-(1:2))), "j", with, environment()), NULL)
test(9999.485, exprCols(x, ((-(1:2))), ".SDcols", with, environment()), error="non existing") #4231
#test(9999.486, exprCols(x, ((-(1:2))), "by", with, environment()), NULL)
test(9999.487, exprCols(x, {{-(1:2)}}, "j", with, environment()), NULL)
test(9999.488, exprCols(x, {{-(1:2)}}, ".SDcols", with, environment()), error="non existing")
#test(9999.489, exprCols(x, {{-(1:2)}}, "by", with, environment()), NULL)
test(9999.491, exprCols(x, !1:2, "j", with, environment()), 3:5)
test(9999.492, exprCols(x, !1:2, ".SDcols", with, environment()), 3:5)
#test(9999.493, exprCols(x, !1:2, "by", with, environment()), 3:5)
test(9999.494, exprCols(x, ((!1:2)), "j", with, environment()), NULL)
test(9999.495, exprCols(x, ((!1:2)), ".SDcols", with, environment()), error="logical and has different length") #4115 #2178
#test(9999.496, exprCols(x, ((!1:2)), "by", with, environment()), NULL)
test(9999.497, exprCols(x, {{!1:2}}, "j", with, environment()), NULL)
test(9999.498, exprCols(x, {{!1:2}}, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.499, exprCols(x, {{!1:2}}, "by", with, environment()), NULL)
test(9999.501, exprCols(x, !(1:2), "j", with, environment()), 3:5)
test(9999.502, exprCols(x, !(1:2), ".SDcols", with, environment()), 3:5)
#test(9999.503, exprCols(x, !(1:2), "by", with, environment()), 3:5)
test(9999.504, exprCols(x, ((!(1:2))), "j", with, environment()), NULL)
test(9999.505, exprCols(x, ((!(1:2))), ".SDcols", with, environment()), error="logical and has different length")
#test(9999.506, exprCols(x, ((!(1:2))), "by", with, environment()), NULL)
test(9999.507, exprCols(x, {{!(1:2)}}, "j", with, environment()), NULL)
test(9999.508, exprCols(x, {{!(1:2)}}, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.509, exprCols(x, {{!(1:2)}}, "by", with, environment()), NULL)
test(9999.511, exprCols(x, c(1,2), "j", with, environment()), 1:2)
test(9999.512, exprCols(x, c(1,2), ".SDcols", with, environment()), 1:2)
#test(9999.513, exprCols(x, c(1,2), "by", with, environment()), 1:2)
test(9999.514, exprCols(x, ((c(1,2))), "j", with, environment()), NULL)
test(9999.515, exprCols(x, ((c(1,2))), ".SDcols", with, environment()), 1:2)
#test(9999.516, exprCols(x, ((c(1,2))), "by", with, environment()), NULL)
test(9999.517, exprCols(x, {{c(1,2)}}, "j", with, environment()), NULL)
test(9999.518, exprCols(x, {{c(1,2)}}, ".SDcols", with, environment()), 1:2)
#test(9999.519, exprCols(x, {{c(1,2)}}, "by", with, environment()), NULL)
test(9999.521, exprCols(x, -c(1,2), "j", with, environment()), 3:5)
test(9999.522, exprCols(x, -c(1,2), ".SDcols", with, environment()), 3:5)
#test(9999.523, exprCols(x, -c(1,2), "by", with, environment()), 3:5)
test(9999.524, exprCols(x, ((-c(1,2))), "j", with, environment()), NULL)
test(9999.525, exprCols(x, ((-c(1,2))), ".SDcols", with, environment()), error="non existing column")
#test(9999.526, exprCols(x, ((-c(1,2))), "by", with, environment()), NULL)
test(9999.527, exprCols(x, {{-c(1,2)}}, "j", with, environment()), NULL)
test(9999.528, exprCols(x, {{-c(1,2)}}, ".SDcols", with, environment()), error="non existing column")
#test(9999.529, exprCols(x, {{-c(1,2)}}, "by", with, environment()), NULL)
test(9999.531, exprCols(x, !c(1,2), "j", with, environment()), 3:5)
test(9999.532, exprCols(x, !c(1,2), ".SDcols", with, environment()), 3:5)
#test(9999.533, exprCols(x, !c(1,2), "by", with, environment()), 3:5)
test(9999.534, exprCols(x, ((!c(1,2))), "j", with, environment()), NULL)
test(9999.535, exprCols(x, ((!c(1,2))), ".SDcols", with, environment()), error="logical and has different length")
#test(9999.536, exprCols(x, ((!c(1,2))), "by", with, environment()), NULL)
test(9999.537, exprCols(x, {{!c(1,2)}}, "j", with, environment()), NULL)
test(9999.538, exprCols(x, {{!c(1,2)}}, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.539, exprCols(x, {{!c(1,2)}}, "by", with, environment()), NULL)
# logical
test(9999.541, exprCols(x, c(TRUE,FALSE,TRUE,FALSE,FALSE), "j", with, environment()), c(1L,3L))
test(9999.542, exprCols(x, c(TRUE,FALSE,TRUE,FALSE,FALSE), ".SDcols", with, environment()), c(1L,3L))
#test(9999.543, exprCols(x, c(TRUE,FALSE,TRUE,FALSE,FALSE), "by", with, environment()), c(1L,3L))
test(9999.554, exprCols(x, ((c(TRUE,FALSE,TRUE,FALSE,FALSE))), "j", with, environment()), NULL)
test(9999.565, exprCols(x, ((c(TRUE,FALSE,TRUE,FALSE,FALSE))), ".SDcols", with, environment()), c(1L,3L))
#test(9999.566, exprCols(x, ((c(TRUE,FALSE,TRUE,FALSE,FALSE))), "by", with, environment()), NULL)
test(9999.567, exprCols(x, {{c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, "j", with, environment()), NULL)
test(9999.568, exprCols(x, {{c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, ".SDcols", with, environment()), c(1L,3L))
#test(9999.569, exprCols(x, {{c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, "by", with, environment()), NULL)
test(9999.571, exprCols(x, -c(TRUE,FALSE,TRUE,FALSE,FALSE), "j", with, environment()), c(2L,4L,5L))
test(9999.572, exprCols(x, -c(TRUE,FALSE,TRUE,FALSE,FALSE), ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.573, exprCols(x, -c(TRUE,FALSE,TRUE,FALSE,FALSE), "by", with, environment()), c(2L,4L,5L))
test(9999.574, exprCols(x, ((-c(TRUE,FALSE,TRUE,FALSE,FALSE))), "j", with, environment()), NULL)
test(9999.575, exprCols(x, ((-c(TRUE,FALSE,TRUE,FALSE,FALSE))), ".SDcols", with, environment()), error="non existing column")
#test(9999.576, exprCols(x, ((-c(TRUE,FALSE,TRUE,FALSE,FALSE))), "by", with, environment()), NULL)
test(9999.577, exprCols(x, {{-c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, "j", with, environment()), NULL)
test(9999.578, exprCols(x, {{-c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, ".SDcols", with, environment()), error="non existing column")
#test(9999.579, exprCols(x, {{-c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, "by", with, environment()), NULL)
test(9999.581, exprCols(x, !c(TRUE,FALSE,TRUE,FALSE,FALSE), "j", with, environment()), c(2L,4L,5L))
test(9999.582, exprCols(x, !c(TRUE,FALSE,TRUE,FALSE,FALSE), ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.583, exprCols(x, !c(TRUE,FALSE,TRUE,FALSE,FALSE), "by", with, environment()), c(2L,4L,5L))
test(9999.584, exprCols(x, ((!c(TRUE,FALSE,TRUE,FALSE,FALSE))), "j", with, environment()), NULL)
test(9999.585, exprCols(x, ((!c(TRUE,FALSE,TRUE,FALSE,FALSE))), ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.586, exprCols(x, ((!c(TRUE,FALSE,TRUE,FALSE,FALSE))), "by", with, environment()), NULL)
test(9999.587, exprCols(x, {{!c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, "j", with, environment()), NULL)
test(9999.588, exprCols(x, {{!c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.589, exprCols(x, {{!c(TRUE,FALSE,TRUE,FALSE,FALSE)}}, "by", with, environment()), NULL)
# character as variable in parent scope
cols = c("V1","V3")
test(9999.601, exprCols(x, cols, "j", with, environment()), error="column name 'cols' is not found")
test(9999.602, exprCols(x, cols, ".SDcols", with, environment()), c(1L,3L))
#test(9999.603, exprCols(x, cols, "by", with, environment()), error="column name 'cols' is not found")
test(9999.604, exprCols(x, ((cols)), "j", with, environment()), NULL)
test(9999.605, exprCols(x, ((cols)), ".SDcols", with, environment()), c(1L,3L))
#test(9999.606, exprCols(x, ((cols)), "by", with, environment()), NULL)
test(9999.607, exprCols(x, {{cols}}, "j", with, environment()), NULL)
test(9999.608, exprCols(x, {{cols}}, ".SDcols", with, environment()), c(1L,3L))
#test(9999.609, exprCols(x, {{cols}}, "by", with, environment()), NULL)
test(9999.611, exprCols(x, -cols, "j", with, environment()), NULL)
test(9999.612, exprCols(x, -cols, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.613, exprCols(x, -cols, "by", with, environment()), NULL)
test(9999.614, exprCols(x, ((-cols)), "j", with, environment()), NULL)
test(9999.615, exprCols(x, ((-cols)), ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.616, exprCols(x, ((-cols)), "by", with, environment()), NULL)
test(9999.617, exprCols(x, {{-cols}}, "j", with, environment()), NULL)
test(9999.618, exprCols(x, {{-cols}}, ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.619, exprCols(x, {{-cols}}, "by", with, environment()), NULL)
test(9999.621, exprCols(x, !cols, "j", with, environment()), NULL)
test(9999.622, exprCols(x, !cols, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.623, exprCols(x, !cols, "by", with, environment()), NULL)
test(9999.624, exprCols(x, ((!cols)), "j", with, environment()), NULL)
test(9999.625, exprCols(x, ((!cols)), ".SDcols", with, environment()), error="invalid argument type")
#test(9999.626, exprCols(x, ((!cols)), "by", with, environment()), NULL)
test(9999.627, exprCols(x, {{!cols}}, "j", with, environment()), NULL)
test(9999.628, exprCols(x, {{!cols}}, ".SDcols", with, environment()), error="invalid argument type")
#test(9999.629, exprCols(x, {{!cols}}, "by", with, environment()), NULL)
test(9999.631, exprCols(x, ..cols, "j", with, environment()), c(1L,3L))
test(9999.632, exprCols(x, ..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.633, exprCols(x, ..cols, "by", with, environment()), c(1L,3L))
test(9999.634, exprCols(x, ((..cols)), "j", with, environment()), NULL)
test(9999.635, exprCols(x, ((..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.636, exprCols(x, ((..cols)), "by", with, environment()), NULL)
test(9999.637, exprCols(x, {{..cols}}, "j", with, environment()), NULL)
test(9999.638, exprCols(x, {{..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.639, exprCols(x, {{..cols}}, "by", with, environment()), NULL)
test(9999.641, exprCols(x, -..cols, "j", with, environment()), c(2L,4L,5L))
test(9999.642, exprCols(x, -..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.643, exprCols(x, -..cols, "by", with, environment()), c(2L,4L,5L))
test(9999.644, exprCols(x, ((-..cols)), "j", with, environment()), NULL)
test(9999.645, exprCols(x, ((-..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.646, exprCols(x, ((-..cols)), "by", with, environment()), NULL)
test(9999.647, exprCols(x, {{-..cols}}, "j", with, environment()), NULL)
test(9999.648, exprCols(x, {{-..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.649, exprCols(x, {{-..cols}}, "by", with, environment()), NULL)
test(9999.651, exprCols(x, !..cols, "j", with, environment()), c(2L,4L,5L))
test(9999.652, exprCols(x, !..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.653, exprCols(x, !..cols, "by", with, environment()), c(2L,4L,5L))
test(9999.654, exprCols(x, ((!..cols)), "j", with, environment()), NULL)
test(9999.655, exprCols(x, ((!..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.656, exprCols(x, ((!..cols)), "by", with, environment()), NULL)
test(9999.657, exprCols(x, {{!..cols}}, "j", with, environment()), NULL)
test(9999.658, exprCols(x, {{!..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.659, exprCols(x, {{!..cols}}, "by", with, environment()), NULL)
rm(cols)
# character as variable in parent scope, variable name overlapping to column name
V1 = c("V1", "V3")
test(9999.701, exprCols(x, V1, "j", with, environment()), NULL)
test(9999.702, exprCols(x, V1, ".SDcols", with, environment()), c(1L,3L))
#test(9999.703, exprCols(x, V1, "by", with, environment()), NULL)
test(9999.704, exprCols(x, ((V1)), "j", with, environment()), NULL)
test(9999.705, exprCols(x, ((V1)), ".SDcols", with, environment()), c(1L,3L))
#test(9999.706, exprCols(x, ((V1)), "by", with, environment()), NULL)
test(9999.707, exprCols(x, {{V1}}, "j", with, environment()), NULL)
test(9999.708, exprCols(x, {{V1}}, ".SDcols", with, environment()), c(1L,3L))
#test(9999.709, exprCols(x, {{V1}}, "by", with, environment()), NULL)
test(9999.711, exprCols(x, -V1, "j", with, environment()), NULL)
test(9999.712, exprCols(x, -V1, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.713, exprCols(x, -V1, "by", with, environment()), NULL)
test(9999.714, exprCols(x, ((-V1)), "j", with, environment()), NULL)
test(9999.715, exprCols(x, ((-V1)), ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.716, exprCols(x, ((-V1)), "by", with, environment()), NULL)
test(9999.717, exprCols(x, {{-V1}}, "j", with, environment()), NULL)
test(9999.718, exprCols(x, {{-V1}}, ".SDcols", with, environment()), error="invalid argument to unary operator")
#test(9999.719, exprCols(x, {{-V1}}, "by", with, environment()), NULL)
test(9999.721, exprCols(x, !V1, "j", with, environment()), NULL)
test(9999.722, exprCols(x, !V1, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.723, exprCols(x, !V1, "by", with, environment()), NULL)
test(9999.724, exprCols(x, ((!V1)), "j", with, environment()), NULL)
test(9999.725, exprCols(x, ((!V1)), ".SDcols", with, environment()), error="invalid argument type")
#test(9999.726, exprCols(x, ((!V1)), "by", with, environment()), NULL)
test(9999.727, exprCols(x, {{!V1}}, "j", with, environment()), NULL)
test(9999.728, exprCols(x, {{!V1}}, ".SDcols", with, environment()), error="invalid argument type")
#test(9999.729, exprCols(x, {{!V1}}, "by", with, environment()), NULL)
test(9999.731, exprCols(x, ..V1, "j", with, environment()), c(1L,3L))
test(9999.732, exprCols(x, ..V1, ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.733, exprCols(x, ..V1, "by", with, environment()), c(1L,3L))
test(9999.734, exprCols(x, ((..V1)), "j", with, environment()), NULL)
test(9999.735, exprCols(x, ((..V1)), ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.736, exprCols(x, ((..V1)), "by", with, environment()), NULL)
test(9999.737, exprCols(x, {{..V1}}, "j", with, environment()), NULL)
test(9999.738, exprCols(x, {{..V1}}, ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.739, exprCols(x, {{..V1}}, "by", with, environment()), NULL)
test(9999.741, exprCols(x, -..V1, "j", with, environment()), c(2L,4L,5L))
test(9999.742, exprCols(x, -..V1, ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.743, exprCols(x, -..V1, "by", with, environment()), c(2L,4L,5L))
test(9999.744, exprCols(x, ((-..V1)), "j", with, environment()), NULL)
test(9999.745, exprCols(x, ((-..V1)), ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.746, exprCols(x, ((-..V1)), "by", with, environment()), NULL)
test(9999.747, exprCols(x, {{-..V1}}, "j", with, environment()), NULL)
test(9999.748, exprCols(x, {{-..V1}}, ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.749, exprCols(x, {{-..V1}}, "by", with, environment()), NULL)
test(9999.751, exprCols(x, !..V1, "j", with, environment()), c(2L,4L,5L))
test(9999.752, exprCols(x, !..V1, ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.753, exprCols(x, !..V1, "by", with, environment()), c(2L,4L,5L))
test(9999.754, exprCols(x, ((!..V1)), "j", with, environment()), NULL)
test(9999.755, exprCols(x, ((!..V1)), ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.756, exprCols(x, ((!..V1)), "by", with, environment()), NULL)
test(9999.757, exprCols(x, {{!..V1}}, "j", with, environment()), NULL)
test(9999.758, exprCols(x, {{!..V1}}, ".SDcols", with, environment()), error="object '..V1' not found")
#test(9999.759, exprCols(x, {{!..V1}}, "by", with, environment()), NULL)
rm(V1)
# numeric as variable in parent scope
cols = c(1,3)
test(9999.801, exprCols(x, cols, "j", with, environment()), error="column name 'cols' is not found")
test(9999.802, exprCols(x, cols, ".SDcols", with, environment()), c(1L,3L))
#test(9999.803, exprCols(x, cols, "by", with, environment()), error="column name 'cols' is not found")
test(9999.804, exprCols(x, ((cols)), "j", with, environment()), NULL)
test(9999.805, exprCols(x, ((cols)), ".SDcols", with, environment()), c(1L,3L))
#test(9999.806, exprCols(x, ((cols)), "by", with, environment()), NULL)
test(9999.807, exprCols(x, {{cols}}, "j", with, environment()), NULL)
test(9999.808, exprCols(x, {{cols}}, ".SDcols", with, environment()), c(1L,3L))
#test(9999.809, exprCols(x, {{cols}}, "by", with, environment()), NULL)
test(9999.811, exprCols(x, -cols, "j", with, environment()), NULL)
test(9999.812, exprCols(x, -cols, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.813, exprCols(x, -cols, "by", with, environment()), NULL)
test(9999.814, exprCols(x, ((-cols)), "j", with, environment()), NULL)
test(9999.815, exprCols(x, ((-cols)), ".SDcols", with, environment()), error="non existing column")
#test(9999.816, exprCols(x, ((-cols)), "by", with, environment()), NULL)
test(9999.817, exprCols(x, {{-cols}}, "j", with, environment()), NULL)
test(9999.818, exprCols(x, {{-cols}}, ".SDcols", with, environment()), error="non existing column")
#test(9999.819, exprCols(x, {{-cols}}, "by", with, environment()), NULL)
test(9999.821, exprCols(x, !cols, "j", with, environment()), NULL)
test(9999.822, exprCols(x, !cols, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.823, exprCols(x, !cols, "by", with, environment()), NULL)
test(9999.824, exprCols(x, ((!cols)), "j", with, environment()), NULL)
test(9999.825, exprCols(x, ((!cols)), ".SDcols", with, environment()), error="logical and has different length")
#test(9999.826, exprCols(x, ((!cols)), "by", with, environment()), NULL)
test(9999.827, exprCols(x, {{!cols}}, "j", with, environment()), NULL)
test(9999.828, exprCols(x, {{!cols}}, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.829, exprCols(x, {{!cols}}, "by", with, environment()), NULL)
test(9999.831, exprCols(x, ..cols, "j", with, environment()), c(1L,3L))
test(9999.832, exprCols(x, ..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.833, exprCols(x, ..cols, "by", with, environment()), c(1L,3L))
test(9999.834, exprCols(x, ((..cols)), "j", with, environment()), NULL)
test(9999.835, exprCols(x, ((..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.836, exprCols(x, ((..cols)), "by", with, environment()), NULL)
test(9999.837, exprCols(x, {{..cols}}, "j", with, environment()), NULL)
test(9999.838, exprCols(x, {{..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.839, exprCols(x, {{..cols}}, "by", with, environment()), NULL)
test(9999.841, exprCols(x, -..cols, "j", with, environment()), c(2L,4L,5L))
test(9999.842, exprCols(x, -..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.843, exprCols(x, -..cols, "by", with, environment()), c(2L,4L,5L))
test(9999.844, exprCols(x, ((-..cols)), "j", with, environment()), NULL)
test(9999.845, exprCols(x, ((-..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.846, exprCols(x, ((-..cols)), "by", with, environment()), NULL)
test(9999.847, exprCols(x, {{-..cols}}, "j", with, environment()), NULL)
test(9999.848, exprCols(x, {{-..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.849, exprCols(x, {{-..cols}}, "by", with, environment()), NULL)
test(9999.851, exprCols(x, !..cols, "j", with, environment()), c(2L,4L,5L))
test(9999.852, exprCols(x, !..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.853, exprCols(x, !..cols, "by", with, environment()), c(2L,4L,5L))
test(9999.854, exprCols(x, ((!..cols)), "j", with, environment()), NULL)
test(9999.855, exprCols(x, ((!..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.856, exprCols(x, ((!..cols)), "by", with, environment()), NULL)
test(9999.857, exprCols(x, {{!..cols}}, "j", with, environment()), NULL)
test(9999.858, exprCols(x, {{!..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.859, exprCols(x, {{!..cols}}, "by", with, environment()), NULL)
rm(cols)
# logical as variable in parent scope
cols = c(TRUE,FALSE,TRUE,FALSE,FALSE)
test(9999.901, exprCols(x, cols, "j", with, environment()), error="column name 'cols' is not found")
test(9999.902, exprCols(x, cols, ".SDcols", with, environment()), c(1L,3L))
#test(9999.903, exprCols(x, cols, "by", with, environment()), error="column name 'cols' is not found")
test(9999.904, exprCols(x, ((cols)), "j", with, environment()), NULL)
test(9999.905, exprCols(x, ((cols)), ".SDcols", with, environment()), c(1L,3L))
#test(9999.906, exprCols(x, ((cols)), "by", with, environment()), NULL)
test(9999.907, exprCols(x, {{cols}}, "j", with, environment()), NULL)
test(9999.908, exprCols(x, {{cols}}, ".SDcols", with, environment()), c(1L,3L))
#test(9999.909, exprCols(x, {{cols}}, "by", with, environment()), NULL)
test(9999.911, exprCols(x, -cols, "j", with, environment()), NULL)
test(9999.912, exprCols(x, -cols, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.913, exprCols(x, -cols, "by", with, environment()), NULL)
test(9999.914, exprCols(x, ((-cols)), "j", with, environment()), NULL)
test(9999.915, exprCols(x, ((-cols)), ".SDcols", with, environment()), error="non existing column")
#test(9999.916, exprCols(x, ((-cols)), "by", with, environment()), NULL)
test(9999.917, exprCols(x, {{-cols}}, "j", with, environment()), NULL)
test(9999.918, exprCols(x, {{-cols}}, ".SDcols", with, environment()), error="non existing column")
#test(9999.919, exprCols(x, {{-cols}}, "by", with, environment()), NULL)
test(9999.921, exprCols(x, !cols, "j", with, environment()), NULL)
test(9999.922, exprCols(x, !cols, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.923, exprCols(x, !cols, "by", with, environment()), NULL)
test(9999.924, exprCols(x, ((!cols)), "j", with, environment()), NULL)
test(9999.925, exprCols(x, ((!cols)), ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.926, exprCols(x, ((!cols)), "by", with, environment()), NULL)
test(9999.927, exprCols(x, {{!cols}}, "j", with, environment()), NULL)
test(9999.928, exprCols(x, {{!cols}}, ".SDcols", with, environment()), c(2L,4L,5L))
#test(9999.929, exprCols(x, {{!cols}}, "by", with, environment()), NULL)
test(9999.931, exprCols(x, ..cols, "j", with, environment()), c(1L,3L))
test(9999.932, exprCols(x, ..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.933, exprCols(x, ..cols, "by", with, environment()), c(1L,3L))
test(9999.934, exprCols(x, ((..cols)), "j", with, environment()), NULL)
test(9999.935, exprCols(x, ((..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.936, exprCols(x, ((..cols)), "by", with, environment()), NULL)
test(9999.937, exprCols(x, {{..cols}}, "j", with, environment()), NULL)
test(9999.938, exprCols(x, {{..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.939, exprCols(x, {{..cols}}, "by", with, environment()), NULL)
test(9999.941, exprCols(x, -..cols, "j", with, environment()), c(2L,4L,5L))
test(9999.942, exprCols(x, -..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.943, exprCols(x, -..cols, "by", with, environment()), c(2L,4L,5L))
test(9999.944, exprCols(x, ((-..cols)), "j", with, environment()), NULL)
test(9999.945, exprCols(x, ((-..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.946, exprCols(x, ((-..cols)), "by", with, environment()), NULL)
test(9999.947, exprCols(x, {{-..cols}}, "j", with, environment()), NULL)
test(9999.948, exprCols(x, {{-..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.949, exprCols(x, {{-..cols}}, "by", with, environment()), NULL)
test(9999.951, exprCols(x, !..cols, "j", with, environment()), c(2L,4L,5L))
test(9999.952, exprCols(x, !..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.953, exprCols(x, !..cols, "by", with, environment()), c(2L,4L,5L))
test(9999.954, exprCols(x, ((!..cols)), "j", with, environment()), NULL)
test(9999.955, exprCols(x, ((!..cols)), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.956, exprCols(x, ((!..cols)), "by", with, environment()), NULL)
test(9999.957, exprCols(x, {{!..cols}}, "j", with, environment()), NULL)
test(9999.958, exprCols(x, {{!..cols}}, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.959, exprCols(x, {{!..cols}}, "by", with, environment()), NULL)
rm(cols)
c1 = c("V1","V3"); c2 = c("V5")
test(9999.961, exprCols(x, c(..c1, ..c2), "j", with, environment()), c(1L,3L,5L))
test(9999.962, exprCols(x, c(..c1, ..c2), ".SDcols", with, environment()), error="object '..c1' not found")
#test(9999.963, exprCols(x, c(..c1, ..c2), "by", with, environment()), c(1L,3L,5L))
test(9999.964, exprCols(x, ((c(..c1, ..c2))), "j", with, environment()), NULL)
test(9999.965, exprCols(x, ((c(..c1, ..c2))), ".SDcols", with, environment()), error="object '..c1' not found")
#test(9999.966, exprCols(x, ((c(..c1, ..c2))), "by", with, environment()), NULL)
test(9999.967, exprCols(x, !c(..c1, ..c2), "j", with, environment()), c(2L,4L))
test(9999.968, exprCols(x, !c(..c1, ..c2), ".SDcols", with, environment()), error="object '..c1' not found")
#test(9999.969, exprCols(x, !c(..c1, ..c2), "by", with, environment()), c(2L,4L))
test(9999.971, exprCols(x, c(..c1, "V5"), "j", with, environment()), c(1L,3L,5L))
test(9999.972, exprCols(x, c(..c1, "V5"), ".SDcols", with, environment()), error="object '..c1' not found")
#test(9999.973, exprCols(x, c(..c1, "V5"), "by", with, environment()), c(1L,3L,5L))
test(9999.974, exprCols(x, ((c(..c1, "V5"))), "j", with, environment()), NULL)
test(9999.975, exprCols(x, ((c(..c1, "V5"))), ".SDcols", with, environment()), error="object '..c1' not found")
#test(9999.976, exprCols(x, ((c(..c1, "V5"))), "by", with, environment()), NULL)
test(9999.977, exprCols(x, !c(..c1, "V5"), "j", with, environment()), c(2L,4L))
test(9999.978, exprCols(x, !c(..c1, "V5"), ".SDcols", with, environment()), error="object '..c1' not found")
#test(9999.979, exprCols(x, !c(..c1, "V5"), "by", with, environment()), c(2L,4L))
rm(c1, c2)
# incorrect length logical #4115 #2178
test(9999.981, exprCols(x, c(TRUE,FALSE,TRUE,FALSE), "j", with, environment()), error="logical and has different length")
test(9999.982, exprCols(x, c(TRUE,FALSE,TRUE,FALSE), ".SDcols", with, environment()), error="logical and has different length")
#test(9999.983, exprCols(x, c(TRUE,FALSE,TRUE,FALSE), "by", with, environment()), error="logical and has different length")
# incorrect length logical as variable in parent scope #4115 #2178
cols = c(TRUE,FALSE,TRUE,FALSE)
test(9999.984, exprCols(x, cols, "j", with, environment()), error="column name 'cols' is not found")
test(9999.985, exprCols(x, cols, ".SDcols", with, environment()), error="logical and has different length")
#test(9999.986, exprCols(x, cols, "by", with, environment()), error="column name 'cols' is not found")
test(9999.987, exprCols(x, ..cols, "j", with, environment()), error="logical and has different length")
test(9999.988, exprCols(x, ..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.989, exprCols(x, ..cols, "by", with, environment()), error="logical and has different length")
rm(cols)
# test for !!V3 --V3
test(9999.9911, exprCols(x, !!V1, "j", with, environment()), NULL)
test(9999.9912, exprCols(x, !!V1, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.9913, exprCols(x, !!V1, "by", with, environment()), NULL)
test(9999.9914, exprCols(x, --V1, "j", with, environment()), NULL)
test(9999.9915, exprCols(x, --V1, ".SDcols", with, environment()), error="object 'V1' not found")
#test(9999.9916, exprCols(x, --V1, "by", with, environment()), NULL)
cols = c("V1","V3")
test(9999.9917, exprCols(x, !!..cols, "j", with, environment()), error="invalid argument type") # consistent to current behaviour but maybe we should defer that to evaluation?
test(9999.9918, exprCols(x, !!..cols, ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.9919, exprCols(x, !!..cols, "by", with, environment()), error="invalid argument type")
rm(cols)
# test after inverse peeling for !("V5")
test(9999.9921, exprCols(x, !("V5"), "j", with, environment()), 1:4)
test(9999.9922, exprCols(x, !("V5"), ".SDcols", with, environment()), 1:4)
#test(9999.9923, exprCols(x, !("V5"), "by", with, environment()), 1:4)
cols = c("V1","V5")
test(9999.9924, exprCols(x, !(..cols), "j", with, environment()), 2:4)
test(9999.9925, exprCols(x, !(..cols), ".SDcols", with, environment()), error="object '..cols' not found")
#test(9999.9926, exprCols(x, !(..cols), "by", with, environment()), 2:4)
rm(cols)
# function
f = function(x) all(x %between% c(2L,4L))
test(9999.9931, exprCols(x, f, "j", with, environment()), error="single symbol but")
test(9999.9932, exprCols(x, f, ".SDcols", with, environment()), 2:4)
test(9999.9933, exprCols(x, !f, "j", with, environment()), NULL) # invalid argument type error raised later on
test(9999.9934, exprCols(x, !f, ".SDcols", with, environment()), c(1L,5L))
rm(f)
test(9999.9935, exprCols(x, function(x) all(x %between% c(2L,4L)), "j", with, environment()), NULL)
test(9999.9936, exprCols(x, function(x) all(x %between% c(2L,4L)), ".SDcols", with, environment()), 2:4)
test(9999.9937, exprCols(x, !function(x) all(x %between% c(2L,4L)), "j", with, environment()), NULL)
test(9999.9938, exprCols(x, !function(x) all(x %between% c(2L,4L)), ".SDcols", with, environment()), c(1L,5L))
# patterns
test(9999.9941, exprCols(x, patterns("V2|V4"), "j", with, environment()), NULL)
test(9999.9942, exprCols(x, !patterns("V2|V4"), "j", with, environment()), NULL)
test(9999.9943, exprCols(x, patterns("V2|V4", "V2|V5"), "j", with, environment()), NULL)
test(9999.9944, exprCols(x, !patterns("V2|V4", "V2|V5"), "j", with, environment()), NULL)
test(9999.9945, exprCols(x, patterns("V2|V4"), ".SDcols", with, environment()), c(2L,4L))
test(9999.9946, exprCols(x, !patterns("V2|V4"), ".SDcols", with, environment()), c(1L,3L,5L))
test(9999.9947, exprCols(x, patterns("V2|V4", "V2|V5"), ".SDcols", with, environment()), 2L)
test(9999.9948, exprCols(x, !patterns("V2|V4", "V2|V5"), ".SDcols", with, environment()), c(1L,3:5))
patterns = c("V1","V2")
test(9999.9951, exprCols(x, patterns, "j", with, environment()), error="single symbol but column name")
test(9999.9952, exprCols(x, patterns, ".SDcols", with, environment()), c(1L,2L))
rm(patterns)
